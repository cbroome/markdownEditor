!function(f){function e(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function l(){var a=require("util");return"Markdown.mk_block( "+a.inspect(this.toString())+", "+a.inspect(this.trailing)+", "+a.inspect(this.lineNumber)+" )"}function k(a){for(var b=0,c=-1;-1!==(c=a.indexOf("\n",c+1));)b++;return b}function n(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}
function s(a){if("string"==typeof a)return n(a);var b=a.shift(),c={},d=[];for(!a.length||"object"!=typeof a[0]||a[0]instanceof Array||(c=a.shift());a.length;)d.push(s(a.shift()));a="";for(var g in c)a+=" "+g+'="'+n(c[g])+'"';return"img"===b||"br"===b||"hr"===b?"<"+b+a+"/>":"<"+b+a+">"+d.join("")+"</"+b+">"}function u(a,b,c){var d;c=c||{};a=a.slice(0);"function"==typeof c.preprocessTreeNode&&(a=c.preprocessTreeNode(a,b));var g=p(a);if(g){a[1]={};for(d in g)a[1][d]=g[d];g=a[1]}if("string"==typeof a)return a;
switch(a[0]){case "header":a[0]="h"+a[1].level;delete a[1].level;break;case "bulletlist":a[0]="ul";break;case "numberlist":a[0]="ol";break;case "listitem":a[0]="li";break;case "para":a[0]="p";break;case "markdown":a[0]="html";g&&delete g.references;break;case "code_block":a[0]="pre";d=g?2:1;var e=["code"];e.push.apply(e,a.splice(d,a.length-d));a[d]=e;break;case "inlinecode":a[0]="code";break;case "img":a[1].src=a[1].href;delete a[1].href;break;case "linebreak":a[0]="br";break;case "link":a[0]="a";
break;case "link_ref":a[0]="a";d=b[g.ref];if(!d)return g.original;delete g.ref;g.href=d.href;d.title&&(g.title=d.title);delete g.original;break;case "img_ref":a[0]="img";d=b[g.ref];if(!d)return g.original;delete g.ref;g.src=d.href;d.title&&(g.title=d.title);delete g.original}if(d=1,g){for(var f in a[1]){d=2;break}1===d&&a.splice(d,1)}for(;d<a.length;++d)a[d]=u(a[d],b,c);return a}function F(a){for(var b=p(a)?2:1;b<a.length;)"string"==typeof a[b]?b+1<a.length&&"string"==typeof a[b+1]?a[b]+=a.splice(b+
1,1)[0]:++b:(F(a[b]),++b)}function w(a,b){function c(a){this.len_after=a;this.name="close_"+b}var d=a+"_state",g="strong"===a?"em_state":"strong_state";return function(e){if(this[d][0]===b)return this[d].shift(),[e.length,new c(e.length-b.length)];var f=this[g].slice(),l=this[d].slice();this[d].unshift(b);var C=this.processInline(e.substr(b.length)),h=C[C.length-1];return(this[d].shift(),h instanceof c)?(C.pop(),[e.length-h.len_after,[a].concat(C)]):(this[g]=f,this[d]=l,[b.length,b])}}var m,x,E,D;
m=function(a,b,c){1===arguments.length&&(b="\n\n");var d=new String(a);return d.trailing=b,d.inspect=l,d.toSource=e,void 0!==c&&(d.lineNumber=c),d};var B=x=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};E=Array.prototype.forEach?function(a,b,c){return a.forEach(b,c)}:function(a,b,c){for(var d=0;d<a.length;d++)b.call(c||a,a[d],d,a)};D=function(a){return B(a)&&1<a.length&&"object"==typeof a[1]&&!B(a[1])?a[1]:void 0};var h=function(a){switch(typeof a){case "undefined":this.dialect=
h.dialects.Gruber;break;case "object":this.dialect=a;break;default:if(!(a in h.dialects))throw Error("Unknown Markdown dialect '"+String(a)+"'");this.dialect=h.dialects[a]}this.em_state=[];this.strong_state=[];this.debug_indent=""};h.dialects={};var r=h.mk_block=m,B=x;h.parse=function(a,b){return(new h(b)).toTree(a)};h.prototype.split_blocks=function(a){a=a.replace(/(\r\n|\n|\r)/g,"\n");var b,c=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,d=[],g=1;for(null!==(b=/^(\s*\n)/.exec(a))&&(g+=k(b[0]),c.lastIndex=
b[0].length);null!==(b=c.exec(a));)"\n#"===b[2]&&(b[2]="\n",c.lastIndex--),d.push(r(b[1],b[2],g)),g+=k(b[0]);return d};h.prototype.processBlock=function(a,b){var c=this.dialect.block,d=c.__order__;if("__call__"in c)return c.__call__.call(this,a,b);for(var g=0;g<d.length;g++){var e=c[d[g]].call(this,a,b);if(e)return(!B(e)||0<e.length&&!B(e[0]))&&this.debug(d[g],"didn't return a proper array"),e}return[]};h.prototype.processInline=function(a){return this.dialect.inline.__call__.call(this,String(a))};
h.prototype.toTree=function(a,b){var c=a instanceof Array?a:this.split_blocks(a),d=this.tree;try{for(this.tree=b||this.tree||["markdown"];c.length;){var g=this.processBlock(c.shift(),c);g.length&&this.tree.push.apply(this.tree,g)}return this.tree}finally{b&&(this.tree=d)}};h.prototype.debug=function(){var a=Array.prototype.slice.call(arguments);a.unshift(this.debug_indent);"undefined"!=typeof print&&print.apply(print,a);"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,
a)};h.prototype.loop_re_over_block=function(a,b,c){var d;for(b=b.valueOf();b.length&&null!==(d=a.exec(b));)b=b.substr(d[0].length),c.call(this,d);return b};h.buildBlockOrder=function(a){var b=[],c;for(c in a)"__order__"!==c&&"__call__"!==c&&b.push(c);a.__order__=b};h.buildInlinePatterns=function(a){var b=[],c;for(c in a)if(!c.match(/^__.*__$/)){var d=c.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");b.push(1===c.length?d:"(?:"+d+")")}b=b.join("|");a.__patterns__=b;var g=a.__call__;a.__call__=
function(a,c){return void 0!==c?g.call(this,a,c):g.call(this,a,b)}};var p=D;h.renderJsonML=function(a,b){b=b||{};b.root=b.root||!1;var c=[];if(b.root)c.push(s(a));else for(a.shift(),!a.length||"object"!=typeof a[0]||a[0]instanceof Array||a.shift();a.length;)c.push(s(a.shift()));return c.join("\n\n")};h.toHTMLTree=function(a,b,c){"string"==typeof a&&(a=this.parse(a,b));b=p(a);var d={};b&&b.references&&(d=b.references);a=u(a,d,c);return F(a),a};h.toHTML=function(a,b,c){a=this.toHTMLTree(a,b,c);return this.renderJsonML(a)};
x={inline_until_char:function(a,b){for(var c=0,d=[];;){if(a.charAt(c)===b)return c++,[c,d];if(c>=a.length)return null;var g=this.dialect.inline.__oneElement__.call(this,a.substr(c)),c=c+g[0];d.push.apply(d,g.slice(1))}},subclassDialect:function(a){function b(){}function c(){}return b.prototype=a.block,c.prototype=a.inline,{block:new b,inline:new c}}};var z=E,p=D,r=m,G=x.inline_until_char;m={block:{atxHeader:function(a,b){var c=a.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(c){var d=["header",{level:c[1].length}];
return Array.prototype.push.apply(d,this.processInline(c[2])),c[0].length<a.length&&b.unshift(r(a.substr(c[0].length),a.trailing,a.lineNumber+2)),[d]}},setextHeader:function(a,b){var c=a.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(c){var d=["header",{level:"="===c[2]?1:2},c[1]];return c[0].length<a.length&&b.unshift(r(a.substr(c[0].length),a.trailing,a.lineNumber+2)),[d]}},code:function(a,b){var c=[],d=/^(?: {0,3}\t| {4})(.*)\n?/;if(a.match(d)){a:for(;;){var g=this.loop_re_over_block(d,a.valueOf(),function(a){c.push(a[1])});
if(g.length){b.unshift(r(g,a.trailing));break a}if(!b.length)break a;if(!b[0].match(d))break a;c.push(a.trailing.replace(/[^\n]/g,"").substring(2));a=b.shift()}return[["code_block",c.join("\n")]]}},horizRule:function(a,b){var c=a.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(c){var d=[["hr"]];if(c[1]){var g=r(c[1],"",a.lineNumber);d.unshift.apply(d,this.toTree(g,[]))}return c[3]&&b.unshift(r(c[3],a.trailing,a.lineNumber+1)),d}},lists:function(){function a(a){return new RegExp("(?:^("+
h+"{0,"+a+"} {0,3})("+g+")\\s+)|(^"+h+"{0,"+(a-1)+"}[ ]{0,4})")}function b(a,b,c,d){if(b)return a.push(["para"].concat(c)),void 0;b=a[a.length-1]instanceof Array&&"para"===a[a.length-1][0]?a[a.length-1]:a;d&&1<a.length&&c.unshift(d);for(a=0;a<c.length;a++)d=c[a],"string"==typeof d&&1<b.length&&"string"==typeof b[b.length-1]?b[b.length-1]+=d:b.push(d)}function c(a,b){for(var c=new RegExp("^("+h+"{"+a+"}.*?\\n?)*$"),d=new RegExp("^"+h+"{"+a+"}","gm"),g=[];0<b.length&&c.exec(b[0]);){var e=b.shift(),
f=e.replace(d,"");g.push(r(f,e.trailing,e.lineNumber))}return g}function d(a,b,c){a=a.list;a=a[a.length-1];a[1]instanceof Array&&"para"===a[1][0]||(b+1===c.length?a.push(["para"].concat(a.splice(1,a.length-1))):(b=a.pop(),a.push(["para"].concat(a.splice(1,a.length-1)),b)))}var g="[*+-]|\\d+\\.",e=/[*+-]/,f=new RegExp("^( {0,3})("+g+")[ \t]+"),h="(?: {0,3}\\t| {4})";return function(g,h){function l(a){var b=e.exec(a[2])?["bulletlist"]:["numberlist"];return q.push({list:b,indent:a[1]}),b}var k=g.match(f);
if(k){for(var v,m,q=[],n=l(k),t=!1,p=[q[0].list];;){for(var r=g.split(/(?=\n)/),y="",s="",u=0;u<r.length;u++){var s="",w=r[u].replace(/^\n/,function(a){return s=a,""});m=a(q.length);if(k=w.match(m),void 0!==k[1]){y.length&&(b(v,t,this.processInline(y),s),t=!1,y="");k[1]=k[1].replace(/ {0,3}\t/g,"    ");var A=Math.floor(k[1].length/4)+1;if(A>q.length)n=l(k),v.push(n),v=n[1]=["listitem"];else{var x=!1;for(m=0;m<q.length;m++)if(q[m].indent===k[1]){n=q[m].list;q.splice(m+1,q.length-(m+1));x=!0;break}x||
(A++,A<=q.length?(q.splice(A,q.length-A),n=q[A-1].list):(n=l(k),v.push(n)));v=["listitem"];n.push(v)}s=""}w.length>k[0].length&&(y+=s+w.substr(k[0].length))}y.length&&(b(v,t,this.processInline(y),s),t=!1,y="");t=c(q.length,h);0<t.length&&(z(q,d,this),v.push.apply(v,this.toTree(t,[])));t=h[0]&&h[0].valueOf()||"";if(!t.match(f)&&!t.match(/^ /))break;g=h.shift();if(t=this.dialect.block.horizRule(g,h)){p.push.apply(p,t);break}z(q,d,this);t=!0}return p}}}(),blockquote:function(a,b){if(a.match(/^>/m)){var c=
[];if(">"!==a[0]){for(var d=a.split(/\n/),g=[],e=a.lineNumber;d.length&&">"!==d[0][0];)g.push(d.shift()),e++;g=r(g.join("\n"),"\n",a.lineNumber);c.push.apply(c,this.processBlock(g,[]));a=r(d.join("\n"),a.trailing,e)}for(;b.length&&">"===b[0][0];)d=b.shift(),a=r(a+a.trailing+d,d.trailing,a.lineNumber);d=a.replace(/^> ?/gm,"");d=(this.tree,this.toTree(d,["blockquote"]));if((e=p(d))&&e.references){delete e.references;var f;a:{for(f in e)if(hasOwnProperty.call(e,f)){f=!1;break a}f=!0}f&&d.splice(1,1)}return c.push(d),
c}},referenceDefn:function(a,b){var c=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(a.match(c)){p(this.tree)||this.tree.splice(1,0,{});var d=p(this.tree);void 0===d.references&&(d.references={});c=this.loop_re_over_block(c,a,function(a){a[2]&&"<"===a[2][0]&&">"===a[2][a[2].length-1]&&(a[2]=a[2].substring(1,a[2].length-1));var b=d.references[a[1].toLowerCase()]={href:a[2]};void 0!==a[4]?b.title=a[4]:void 0!==a[5]&&(b.title=a[5])});return c.length&&b.unshift(r(c,a.trailing)),[]}},
para:function(a){return[["para"].concat(this.processInline(a))]}},inline:{__oneElement__:function(a,b,c){var d,g;b=b||this.dialect.inline.__patterns__;return(d=(new RegExp("([\\s\\S]*?)("+(b.source||b)+")")).exec(a),d)?d[1]?[d[1].length,d[1]]:(d[2]in this.dialect.inline&&(g=this.dialect.inline[d[2]].call(this,a.substr(d.index),d,c||[])),g||[d[2].length,d[2]]):[a.length,a]},__call__:function(a,b){function c(a){"string"==typeof a&&"string"==typeof g[g.length-1]?g[g.length-1]+=a:g.push(a)}for(var d,
g=[];0<a.length;)d=this.dialect.inline.__oneElement__.call(this,a,b,g),a=a.substr(d.shift()),z(d,c);return g},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(a){return this.dialect.inline.__escape__.exec(a)?[2,a.charAt(1)]:[1,"\\"]},"![":function(a){var b=a.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);return b?(b[2]&&"<"===b[2][0]&&">"===b[2][b[2].length-1]&&(b[2]=b[2].substring(1,b[2].length-1)),b[2]=this.dialect.inline.__call__.call(this,
b[2],/\\/)[0],a={alt:b[1],href:b[2]||""},void 0!==b[4]&&(a.title=b[4]),[b[0].length,["img",a]]):(b=a.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),b?[b[0].length,["img_ref",{alt:b[1],ref:b[2].toLowerCase(),original:b[0]}]]:[2,"!["])},"[":function(a){var b=String(a),c=G.call(this,a.substr(1),"]");if(!c)return[1,"["];var d,g,e=1+c[0],c=c[1];a=a.substr(e);var f=a.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(f){a=f[1];if(e+=f[0].length,a&&"<"===a[0]&&">"===a[a.length-1]&&(a=a.substring(1,a.length-
1)),!f[3])for(var b=1,h=0;h<a.length;h++)switch(a[h]){case "(":b++;break;case ")":0===--b&&(e-=a.length-h,a=a.substring(0,h))}return a=this.dialect.inline.__call__.call(this,a,/\\/)[0],g={href:a||""},void 0!==f[3]&&(g.title=f[3]),d=["link",g].concat(c),[e,d]}return f=a.match(/^\s*\[(.*?)\]/),f?(e+=f[0].length,g={ref:(f[1]||String(c)).toLowerCase(),original:b.substr(0,e)},d=["link_ref",g].concat(c),[e,d]):1===c.length&&"string"==typeof c[0]?(g={ref:c[0].toLowerCase(),original:b.substr(0,e)},d=["link_ref",
g,c[0]],[e,d]):[1,"["]},"<":function(a){var b;return null!==(b=a.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?b[3]?[b[0].length,["link",{href:"mailto:"+b[3]},b[3]]]:"mailto"===b[2]?[b[0].length,["link",{href:b[1]},b[1].substr(7)]]:[b[0].length,["link",{href:b[1]},b[1]]]:[1,"<"]},"`":function(a){return(a=a.match(/(`+)(([\s\S]*?)\1)/))&&a[2]?[a[1].length+a[2].length,["inlinecode",a[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}}};m.inline["**"]=w("strong","**");m.inline.__=
w("strong","__");m.inline["*"]=w("em","*");m.inline._=w("em","_");h.dialects.Gruber=m;h.buildBlockOrder(h.dialects.Gruber.block);h.buildInlinePatterns(h.dialects.Gruber.inline);m=x.subclassDialect(m);p=D;z=E;m.processMetaHash=function(a){var b=a.split("");a=[""];for(var c=!1;b.length;){var d=b.shift();switch(d){case " ":c?a[a.length-1]+=d:a.push("");break;case "'":case '"':c=!c;break;case "\\":d=b.shift();default:a[a.length-1]+=d}}b={};for(c=0;c<a.length;++c)/^#/.test(a[c])?b.id=a[c].substring(1):
/^\./.test(a[c])?b["class"]=b["class"]?b["class"]+a[c].replace(/./," "):a[c].substring(1):/\=/.test(a[c])&&(d=a[c].split(/\=/),b[d[0]]=d[1]);return b};m.block.document_meta=function(a){if(!(1<a.lineNumber)&&a.match(/^(?:\w+:.*\n)*\w+:.*$/)){p(this.tree)||this.tree.splice(1,0,{});a=a.split(/\n/);for(var b in a){var c=a[b].match(/(\w+):\s*(.*)$/),d=c[1].toLowerCase();this.tree[1][d]=c[2]}return[]}};m.block.block_meta=function(a){var b=a.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(b){var c=
this.dialect.processMetaHash(b[2]);if(""===b[1]){b=this.tree[this.tree.length-1];if(a=p(b),"string"==typeof b)return;a||(a={},b.splice(1,0,a));for(var d in c)a[d]=c[d];return[]}a=a.replace(/\n.*$/,"");b=this.processBlock(a,[]);(a=p(b[0]))||(a={},b[0].splice(1,0,a));for(d in c)a[d]=c[d];return b}};m.block.definition_list=function(a,b){var c,d=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,e=["dl"];if(a.match(d)){for(var f=[a];b.length&&d.exec(b[0]);)f.push(b.shift());for(var h=0;h<f.length;++h){c=f[h].match(d);
var l=c[1].replace(/\n$/,"").split(/\n/),k=c[2].split(/\n:\s+/);for(c=0;c<l.length;++c)e.push(["dt",l[c]]);for(c=0;c<k.length;++c)e.push(["dd"].concat(this.processInline(k[c].replace(/(\n)\s+/,"$1"))))}return[e]}};m.block.table=function(a){var b,c,d=function(a,b){b=b||"\\s";b.match(/^[\\|\[\]{}?*.+^$]$/)&&(b="\\"+b);for(var c,d=[],e=new RegExp("^((?:\\\\.|[^\\\\"+b+"])*)"+b+"(.*)");c=a.match(e);)d.push(c[1]),a=c[2];return d.push(a),d},e=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;
if(c=a.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))c[3]=c[3].replace(/^\s*\|/gm,"");else if(!(c=a.match(e)))return;var f=["table",["thead",["tr"]],["tbody"]];c[2]=c[2].replace(/\|\s*$/,"").split("|");var h=[];z(c[2],function(a){a.match(/^\s*-+:\s*$/)?h.push({align:"right"}):a.match(/^\s*:-+\s*$/)?h.push({align:"left"}):a.match(/^\s*:-+:\s*$/)?h.push({align:"center"}):h.push({})});c[1]=d(c[1].replace(/\|\s*$/,""),"|");for(b=0;b<c[1].length;b++)f[1][1].push(["th",
h[b]||{}].concat(this.processInline(c[1][b].trim())));return z(c[3].replace(/\|\s*$/gm,"").split("\n"),function(a){var c=["tr"];a=d(a,"|");for(b=0;b<a.length;b++)c.push(["td",h[b]||{}].concat(this.processInline(a[b].trim())));f[2].push(c)},this),[f]};m.inline["{:"]=function(a,b,c){if(!c.length)return[2,"{:"];b=c[c.length-1];if("string"==typeof b)return[2,"{:"];a=a.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!a)return[2,"{:"];c=this.dialect.processMetaHash(a[1]);var d=p(b);d||(d={},b.splice(1,0,d));
for(var e in c)d[e]=c[e];return[a[0].length,""]};h.dialects.Maruku=m;h.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/;h.buildBlockOrder(h.dialects.Maruku.block);h.buildInlinePatterns(h.dialects.Maruku.inline);f.Markdown=h;f.parse=h.parse;f.toHTML=h.toHTML;f.toHTMLTree=h.toHTMLTree;f.renderJsonML=h.renderJsonML}(function(){return window.markdown={},window.markdown}());(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):f(jQuery)})(function(f){f.fn.markdownEditor=function(e,l){return{init:f.proxy(f.fn.markdownEditor.init,this),getHTML:f.proxy(f.fn.markdownEditor.getHTML,this),getMarkdown:f.proxy(f.fn.markdownEditor.getMarkdown,this),setValue:f.proxy(f.fn.markdownEditor.setValue,this),addButton:f.proxy(f.fn.markdownEditor.addButton,this),addComponent:f.proxy(f.fn.markdownEditor.addComponent,this),getSelection:f.proxy(f.fn.markdownEditor.getSelection,
this)}[e](l)};f.fn.markdownEditor.init=function(e){var l=f(this);e=new f.fn.markdownEditor.MarkdownEditor(l,e);e.render();l.data("markdownEditor",e);return this};f.fn.markdownEditor.getHTML=function(){return f(this).data("markdownEditor").getHTML()};f.fn.markdownEditor.getMarkdown=function(){return f(this).data("markdownEditor").getMarkdown()};f.fn.markdownEditor.setValue=function(e){return f(this).data("markdownEditor").setValue(e)};f.fn.markdownEditor.addButton=function(e){return f(this).data("markdownEditor").addButton(e)};
f.fn.markdownEditor.addComponent=function(e){return f(this).data("markdownEditor").addComponent(e)};f.fn.markdownEditor.getSelection=function(){return f(this).data("markdownEditor").getSelection()};f.fn.markdownEditor.MarkdownEditor=function(e,l){this.$el=e;f.extend(this.options,l||{});this.initialize()};f.extend(f.fn.markdownEditor.MarkdownEditor.prototype,{$textarea:void 0,$preview:void 0,$buttonBar:void 0,options:{initString:void 0,markdownAttrs:void 0,previewAttrs:void 0},_buttonBold:function(e){return"**"+
e+"**"},_buttonItalic:function(e){return"*"+e+"*"},_buttonUnderline:function(e){return"_"+e+"_"},_buttonClick:function(e){var f,k,n,s,u;e&&(n=this.$textarea.val(),u=this.getSelection(),f=u.start,k=u.end,e=e(u.selection))&&(k=n.substring(0,f)+e+n.substring(k,n.length),this.$textarea.val(k),s=f+e.length,this.$textarea.focus(),this.$textarea.each(function(e,f){f.setSelectionRange(s,s)}),this._updatePreview())},_defaultButtons:function(){return[{label:"B",name:"bold",functionality:this._buttonBold},{label:"I",
name:"italic",functionality:this._buttonItalic},{label:"U",name:"underline",functionality:this._buttonUnderline}]},_updatePreview:function(){var e=this.$textarea.val(),l=/!!!UNIQUE_TOKEN!!!/,e=f("<div />").append(e),k=[],n;e.first().contents().each(function(){1===this.nodeType&&(k.push(f(this).clone().wrap("<p>").parent().html()),f(this).replaceWith("!!!UNIQUE_TOKEN!!!"))});for(n=markdown.toHTML(e.html());k.length;)e=k.shift(),n=n.replace(l,e);this.$preview.html(n)},_createColumn:function(e){var l=
f('<div class="md-column" />');e&&l.append(e);return l},_textareaBehavior:function(e){if(9===e.keyCode){var f=e.target.selectionStart,k=e.target.selectionEnd,n=this.$textarea.val();this.$textarea.val(n.substring(0,f)+"\t"+n.substring(k));e.target.selectionStart=e.target.selectionEnd=f+1;e.preventDefault()}},_buildButton:function(e){var l=f('<button type="button">'+e.label+"</button>");(functionality=e.functionality)&&l.click(f.proxy(this._buttonClick,this,functionality));this.$buttonBar.append(l)},
_buildButtonBar:function(){var e=this._defaultButtons(),f=e.length,k;for(k=0;k<f;k++)this._buildButton(e[k])},initialize:function(){this.options.initString=this.options.initString||decodeURI(this.$el.html())},render:function(){var e=f.proxy(this._updatePreview,this),l;this.$el.addClass("md-markdown-editor");this.$textarea=f("<textarea />").val(this.options.initString);this.$buttonBar=f('<div class="md-button-bar" />');this.$preview=f('<div class="md-preview" />');this.$el.empty();this._buildButtonBar();
l=this._createColumn();l.append(this.$buttonBar);l.append(this.$textarea);this.$el.append(l).append(this._createColumn(this.$preview));this.options.markdownAttrs&&this.$textarea.attr(this.options.markdownAttrs);this.options.previewAttrs&&this.$textarea.attr(this.options.previewAttrs);this.$textarea.on("input",e).on("keyup",e).on("keydown",e);this.$textarea.keydown(f.proxy(this._textareaBehavior,this));this._updatePreview();return this},getMarkdown:function(){return this.$textarea.val()},getHTML:function(){return this.$preview.html()},
setValue:function(e){this.$textarea.val(e);this._updatePreview();return this},addButton:function(e){this._buildButton(e);return this},addComponent:function(e){this.$buttonBar.append(e)},getSelection:function(){var e,f,k;e=this.$textarea.val();f=this.$textarea[0].selectionStart;k=this.$textarea[0].selectionEnd;e=e.substring(f,k);return{start:f,end:k,selection:e}}})});
